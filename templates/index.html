<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cobotics4All - Asset Umbrella</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Icons are pre-defined as SVG strings in JS for performance -->
    <style>
        body { background-color: #f1f5f9; color: #0f172a; }
        .fade-in { animation: fadeIn 0.2s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        /* Tab active state */
        .nav-btn.active { background-color: rgba(45, 212, 191, 0.1); color: #2dd4bf; border-right: 4px solid #2dd4bf; }
        .nav-btn:hover:not(.active) { background-color: #1e293b; color: white; }
    </style>
</head>
<body class="flex min-h-screen font-sans text-slate-900">

    <!-- NAVIGATION -->
    <nav class="w-64 bg-slate-900 text-slate-300 flex flex-col h-screen sticky top-0 shadow-xl flex-shrink-0">
        <div class="p-6 flex items-center gap-3 text-white border-b border-slate-800">
            <svg class="w-8 h-8 text-teal-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="16" y="16" width="6" height="6" rx="1"/><rect x="2" y="16" width="6" height="6" rx="1"/><rect x="9" y="2" width="6" height="6" rx="1"/><path d="M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3"/><path d="M12 12V8"/></svg>
            <span class="text-xl font-bold tracking-wider">COBOTICS4ALL</span>
        </div>
        <div class="flex-1 py-6 space-y-2">
            <button onclick="switchTab('dashboard')" id="btn-dashboard" class="nav-btn active w-full flex items-center gap-3 px-6 py-3 transition-all duration-200">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
                <span class="font-medium">Dashboard</span>
            </button>
            <button onclick="switchTab('challenges')" id="btn-challenges" class="nav-btn w-full flex items-center gap-3 px-6 py-3 transition-all duration-200">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
                <span class="font-medium">Challenges</span>
            </button>
            <button onclick="switchTab('missions')" id="btn-missions" class="nav-btn w-full flex items-center gap-3 px-6 py-3 transition-all duration-200">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></svg>
                <span class="font-medium">Missions</span>
            </button>
            <button onclick="switchTab('taskplots')" id="btn-taskplots" class="nav-btn w-full flex items-center gap-3 px-6 py-3 transition-all duration-200">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></svg>
                <span class="font-medium">Task Plots</span>
            </button>
        </div>
    </nav>

    <!-- CONTENT -->
    <main class="flex-1 p-8 overflow-y-auto h-screen">
        <div class="max-w-6xl mx-auto">
            
            <!-- DASHBOARD VIEW -->
            <div id="view-dashboard" class="view-section fade-in">
                <header class="mb-8">
                    <h1 class="text-3xl font-bold text-slate-800">System Overview</h1>
                    <p class="text-slate-500">Static build generated on render.</p>
                </header>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Stats Cards -->
                    <div class="bg-white p-6 rounded-xl border-l-4 border-indigo-500 shadow-sm">
                        <div class="text-sm font-bold text-indigo-500">CHALLENGES</div>
                        <div class="text-4xl font-bold text-slate-800 mt-2">{{ challenges|length }}</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl border-l-4 border-teal-500 shadow-sm">
                        <div class="text-sm font-bold text-teal-500">MISSIONS</div>
                        <div class="text-4xl font-bold text-slate-800 mt-2">{{ missions|length }}</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl border-l-4 border-amber-500 shadow-sm">
                        <div class="text-sm font-bold text-amber-500">TASK PLOTS</div>
                        <div class="text-4xl font-bold text-slate-800 mt-2">{{ task_plots|length }}</div>
                    </div>
                </div>
            </div>

            <!-- CHALLENGES VIEW -->
            <div id="view-challenges" class="view-section hidden fade-in space-y-6">
                <h2 class="text-2xl font-bold text-slate-800">Challenge Journeys</h2>
                {% for c in challenges %}
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="bg-slate-50 p-4 border-b border-slate-200 flex justify-between items-center">
                        <h3 class="text-lg font-bold text-slate-800">{{ c.title }}</h3>
                        <span class="text-xs font-mono text-slate-400 uppercase">ID: {{ c.id }}</span>
                    </div>
                    <div class="p-6 grid md:grid-cols-2 gap-8">
                        <div class="space-y-4">
                            <div><h4 class="text-xs font-bold text-slate-400 uppercase">Context</h4><p class="text-slate-700">{{ c.context }}</p></div>
                            <div><h4 class="text-xs font-bold text-slate-400 uppercase">Goal</h4><p class="text-slate-700">{{ c.solutionGoal }}</p></div>
                        </div>
                        <div class="bg-indigo-50/50 p-4 rounded border border-indigo-100">
                            <h4 class="text-sm font-bold text-indigo-900 mb-2">Active Missions</h4>
                            {% if c.missionIds %}
                                {% for mid in c.missionIds %}
                                    {% for m in missions %}
                                        {% if m.id == mid %}
                                        <div class="bg-white p-2 mb-1 rounded border border-indigo-100 text-sm text-indigo-800 shadow-sm">{{ m.title }}</div>
                                        {% endif %}
                                    {% endfor %}
                                {% endfor %}
                            {% else %}
                                <span class="text-slate-400 italic text-sm">No missions assigned</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- MISSIONS VIEW -->
            <div id="view-missions" class="view-section hidden fade-in space-y-6">
                <h2 class="text-2xl font-bold text-slate-800">Missions</h2>
                {% for m in missions %}
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex flex-col md:flex-row gap-6">
                    <div class="flex-1">
                        <h3 class="text-lg font-bold text-slate-800 mb-2">{{ m.title }}</h3>
                        <div class="text-sm text-slate-500 mb-4">Platform: {{ m.robotPlatform }}</div>
                        <p class="text-slate-700 text-sm">{{ m.description }}</p>
                    </div>
                    <div class="w-full md:w-1/3 bg-slate-50 rounded p-4 border border-slate-200">
                        <h4 class="text-xs font-bold text-slate-500 uppercase mb-3">Task Plot Sequence</h4>
                        <ul class="space-y-2">
                            {% for tid in m.taskPlotIds %}
                                {% for tp in task_plots %}
                                    {% if tp.id == tid %}
                                    <li class="text-sm bg-white p-2 rounded border border-slate-200 shadow-sm flex gap-2">
                                        <span class="w-5 h-5 bg-amber-100 text-amber-700 rounded-full flex items-center justify-center text-xs font-bold">{{ loop.index }}</span>
                                        {{ tp.title }}
                                    </li>
                                    {% endif %}
                                {% endfor %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- TASK PLOTS VIEW -->
            <div id="view-taskplots" class="view-section hidden fade-in space-y-6">
                <h2 class="text-2xl font-bold text-slate-800">Task Plots</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {% for tp in task_plots %}
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full bg-amber-400"></div>
                    <div class="pl-3">
                        <h3 class="font-bold text-slate-800 mb-2">{{ tp.title }}</h3>
                        <p class="text-sm text-slate-600 mb-3">{{ tp.description }}</p>
                        <div class="flex items-center gap-2 text-xs mb-3">
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded">Start: {{ tp.startCondition }}</span>
                            <span class="text-slate-300">➔</span>
                            <span class="bg-red-100 text-red-800 px-2 py-1 rounded">End: {{ tp.endCondition }}</span>
                        </div>
                        <div class="pt-3 border-t border-slate-100">
                            <div class="text-xs font-bold text-slate-400 uppercase mb-2">Skills</div>
                            <div class="flex flex-wrap gap-1">
                                {% for sid in tp.skills %}
                                    {% for s in skills %}
                                        {% if s.id == sid %}
                                        <a href="{{ s.url }}" target="_blank" class="text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded hover:bg-indigo-50 hover:text-indigo-600 transition-colors">
                                            {{ s.name }} ↗
                                        </a>
                                        {% endif %}
                                    {% endfor %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
                </div>
            </div>

        </div>
    </main>

    <script>
        // Simple Vanilla JS for Tab Switching
        function switchTab(tabId) {
            // Hide all views
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            // Show selected view
            document.getElementById('view-' + tabId).classList.remove('hidden');
            
            // Update buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('text-slate-400');
            });
            const activeBtn = document.getElementById('btn-' + tabId);
            activeBtn.classList.add('active');
            activeBtn.classList.remove('text-slate-400');
        }
    </script>
</body>
</html>
